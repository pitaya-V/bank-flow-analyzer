<Window x:Class="BankFlowAnalyzer.Views.ProjectPickerWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="选择/创建项目" Height="420" Width="952" WindowStartupLocation="CenterScreen">
    <Window.Resources>
        <Style x:Key="PickerBtn" TargetType="Button">
            <Setter Property="Width" Value="120"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Margin" Value="0,0,8,0"/>
        </Style>
    </Window.Resources>

    <Grid Margin="12">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*"/>
            <ColumnDefinition Width="3*"/>
        </Grid.ColumnDefinitions>

        <!-- 左侧：新建 -->
        <StackPanel Grid.Column="0">
            <TextBlock Text="新建项目" FontSize="16" FontWeight="Bold" Margin="0,0,0,8"/>
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="案号" Width="60" VerticalAlignment="Center"/>
                <TextBox Text="{Binding NewCaseNo, UpdateSourceTrigger=PropertyChanged}" Width="220"/>
            </StackPanel>
            <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                <TextBlock Text="标题" Width="60" VerticalAlignment="Center"/>
                <TextBox Text="{Binding NewTitle, UpdateSourceTrigger=PropertyChanged}" Width="220"/>
            </StackPanel>
            <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                <Button Content="创建" Command="{Binding CreateCommand}" Style="{StaticResource PickerBtn}"/>
                <Button Content="取消" Command="{Binding CancelCommand}" Style="{StaticResource PickerBtn}"/>
            </StackPanel>
            <TextBlock Text="{Binding Status}" Foreground="Gray" Margin="0,6,0,0"/>
        </StackPanel>

        <!-- 右侧：最近项目 -->
        <StackPanel Grid.Column="1" Margin="16,0,0,0">
            <TextBlock Text="最近项目" FontSize="16" FontWeight="Bold" Margin="0,0,0,8"/>
            <DataGrid ItemsSource="{Binding Recents}"
                      SelectedItem="{Binding SelectedRecent, Mode=TwoWay}"
                      AutoGenerateColumns="False" IsReadOnly="True" Height="260"
                      MouseDoubleClick="DataGrid_MouseDoubleClick">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="案号" Binding="{Binding CaseNo}" Width="*"/>
                    <DataGridTextColumn Header="标题" Binding="{Binding Title}" Width="*"/>
                    <DataGridTextColumn Header="路径" Binding="{Binding DbPath}" Width="2*"/>
                    <DataGridTextColumn Header="最近打开(UTC)" Binding="{Binding LastOpenedUtc}" Width="*"/>
                </DataGrid.Columns>
            </DataGrid>

            <StackPanel Orientation="Horizontal" Margin="0,8,0,0" VerticalAlignment="Center">
                <Button Content="打开所选" Command="{Binding OpenSelectedCommand}" Style="{StaticResource PickerBtn}"/>
                <Button Content="移除所选" Command="{Binding RemoveSelectedCommand}" Style="{StaticResource PickerBtn}"/>
                <Button Content="打开 .db 文件..." Command="{Binding OpenFromFileCommand}" Style="{StaticResource PickerBtn}"/>
                <CheckBox Content="同时删除磁盘文件" Margin="8,4,0,0"
                          IsChecked="{Binding DeletePhysical, Mode=TwoWay}"/>
            </StackPanel>
        </StackPanel>
    </Grid>
</Window>
